"""
Base de données des retailers français.
Play Store IDs, App Store IDs, et réseaux sociaux vérifiés.
"""

RETAILERS = {
    # ==========================================================================
    # GRANDE DISTRIBUTION
    # ==========================================================================
    "supermarche": {
        "name": "Grande Distribution",
        "retailers": {
            "carrefour": {
                "name": "Carrefour",
                "website": "https://www.carrefour.fr",
                "playstore_app_id": "com.carrefour.smartphone",
                "appstore_app_id": "350126498",
                "instagram_username": "carrefourfrance",
                "tiktok_username": "carrefourfrance",
                "youtube_channel_id": "UCMvbnJ7cLfY4KQPGU3IEuYg",
                "stores_count": 5000,
            },
            "leclerc": {
                "name": "E.Leclerc",
                "website": "https://www.e.leclerc",
                "playstore_app_id": "com.eleclerc.moneleclerc",
                "appstore_app_id": "1193842898",
                "instagram_username": "e.leclerc",
                "tiktok_username": "e.leclerc",
                "stores_count": 700,
            },
            "auchan": {
                "name": "Auchan",
                "website": "https://www.auchan.fr",
                "playstore_app_id": "com.auchan.retail.android.customers.france",
                "appstore_app_id": "541227977",
                "instagram_username": "auchan_france",
                "stores_count": 600,
            },
            "intermarche": {
                "name": "Intermarché",
                "website": "https://www.intermarche.com",
                "playstore_app_id": "com.intermarche.mobile.courses",
                "appstore_app_id": "1447048498",
                "instagram_username": "interaborateur",
                "stores_count": 1800,
            },
            "lidl": {
                "name": "Lidl",
                "website": "https://www.lidl.fr",
                "playstore_app_id": "com.lidl.eci.lidlplus",
                "appstore_app_id": "1270994986",
                "instagram_username": "lidlfrance",
                "tiktok_username": "lidlfrance",
                "stores_count": 1600,
            },
            "aldi": {
                "name": "Aldi",
                "website": "https://www.aldi.fr",
                "playstore_app_id": "com.aldi.mobile.android.france",
                "appstore_app_id": "1525458498",
                "instagram_username": "aldi_france",
                "stores_count": 1300,
            },
            "monoprix": {
                "name": "Monoprix",
                "website": "https://www.monoprix.fr",
                "playstore_app_id": "fr.monoprix.monoprix",
                "appstore_app_id": "966459890",
                "instagram_username": "monoprix",
                "stores_count": 800,
            },
            "franprix": {
                "name": "Franprix",
                "website": "https://www.franprix.fr",
                "playstore_app_id": "com.franprix.fidall",
                "appstore_app_id": "1434696654",
                "instagram_username": "franprix_officiel",
                "stores_count": 900,
            },
            "casino": {
                "name": "Casino",
                "website": "https://www.supercasino.fr",
                "playstore_app_id": "com.casino.casinomax",
                "appstore_app_id": "1508465296",
                "instagram_username": "supermarchescasino",
                "stores_count": 400,
            },
            "systeme_u": {
                "name": "Système U",
                "website": "https://www.magasins-u.com",
                "playstore_app_id": "com.systemu.coursesu",
                "appstore_app_id": "1437084256",
                "instagram_username": "magasins_u",
                "stores_count": 1600,
            },
        },
    },
    # ==========================================================================
    # MODE & HABILLEMENT
    # ==========================================================================
    "mode": {
        "name": "Mode & Habillement",
        "retailers": {
            "zara": {
                "name": "Zara",
                "website": "https://www.zara.com/fr",
                "playstore_app_id": "com.inditex.zara",
                "appstore_app_id": "547347221",
                "instagram_username": "zara",
                "tiktok_username": "zara",
                "stores_count": 150,
            },
            "hm": {
                "name": "H&M",
                "website": "https://www.hm.com/fr",
                "playstore_app_id": "com.hm.goe",
                "appstore_app_id": "834465911",
                "instagram_username": "hm",
                "tiktok_username": "hm",
                "stores_count": 200,
            },
            "kiabi": {
                "name": "Kiabi",
                "website": "https://www.kiabi.com",
                "playstore_app_id": "com.kiabi.kiabi",
                "appstore_app_id": "495571498",
                "instagram_username": "kiabi_official",
                "stores_count": 500,
            },
            "decathlon": {
                "name": "Decathlon",
                "website": "https://www.decathlon.fr",
                "playstore_app_id": "com.decathlon.app",
                "appstore_app_id": "1079647629",
                "instagram_username": "decathlon",
                "tiktok_username": "decathlon",
                "stores_count": 350,
            },
            "celio": {
                "name": "Celio",
                "website": "https://www.celio.com",
                "playstore_app_id": "com.micropole.celio",
                "appstore_app_id": "666408691",
                "instagram_username": "celio_official",
                "stores_count": 500,
            },
            "jules": {
                "name": "Jules",
                "website": "https://www.jules.com",
                "playstore_app_id": "com.jules.app",
                "appstore_app_id": "1511098097",
                "instagram_username": "jules_officiel",
                "stores_count": 400,
            },
            "pimkie": {
                "name": "Pimkie",
                "website": "https://www.pimkie.fr",
                "playstore_app_id": "com.pimkie.pimkie",
                "appstore_app_id": "1514299166",
                "instagram_username": "pimaborateur",
                "stores_count": 300,
            },
        },
    },
    # ==========================================================================
    # BEAUTÉ & COSMÉTIQUES
    # ==========================================================================
    "beaute": {
        "name": "Beauté & Cosmétiques",
        "retailers": {
            "sephora": {
                "name": "Sephora",
                "website": "https://www.sephora.fr",
                "playstore_app_id": "com.sephora",
                "appstore_app_id": "393328150",
                "instagram_username": "sephorafrance",
                "tiktok_username": "sephora",
                "stores_count": 300,
            },
            "nocibe": {
                "name": "Nocibé",
                "website": "https://www.nocibe.fr",
                "playstore_app_id": "com.nocibe.app",
                "appstore_app_id": "1123649654",
                "instagram_username": "nocibe_france",
                "stores_count": 600,
            },
            "marionnaud": {
                "name": "Marionnaud",
                "website": "https://www.marionnaud.fr",
                "playstore_app_id": "com.marionnaud.france",
                "appstore_app_id": "1114798700",
                "instagram_username": "marionnaud_france",
                "stores_count": 500,
            },
            "yves_rocher": {
                "name": "Yves Rocher",
                "website": "https://www.yves-rocher.fr",
                "playstore_app_id": "com.yvesrocher.france",
                "appstore_app_id": "1439687168",
                "instagram_username": "yvesrocherusa",
                "stores_count": 700,
            },
        },
    },
    # ==========================================================================
    # ÉLECTROMÉNAGER & HIGH-TECH
    # ==========================================================================
    "electromenager": {
        "name": "Électroménager & High-Tech",
        "retailers": {
            "darty": {
                "name": "Darty",
                "website": "https://www.darty.com",
                "playstore_app_id": "com.darty.dartycom",
                "appstore_app_id": "352210890",
                "instagram_username": "darty_officiel",
                "stores_count": 400,
            },
            "boulanger": {
                "name": "Boulanger",
                "website": "https://www.boulanger.com",
                "playstore_app_id": "fr.boulanger.shoppingapp",
                "appstore_app_id": "412042787",
                "instagram_username": "boulanger",
                "stores_count": 200,
            },
            "fnac": {
                "name": "Fnac",
                "website": "https://www.fnac.com",
                "playstore_app_id": "com.fnac.android",
                "appstore_app_id": "378498309",
                "instagram_username": "fnac_officiel",
                "stores_count": 500,
            },
            "ldlc": {
                "name": "LDLC",
                "website": "https://www.ldlc.com",
                "playstore_app_id": "com.ldlc.ldlc",
                "appstore_app_id": "589168498",
                "instagram_username": "ldlc_officiel",
                "stores_count": 100,
            },
        },
    },
    # ==========================================================================
    # BRICOLAGE & MAISON
    # ==========================================================================
    "bricolage": {
        "name": "Bricolage & Maison",
        "retailers": {
            "leroy_merlin": {
                "name": "Leroy Merlin",
                "website": "https://www.leroymerlin.fr",
                "playstore_app_id": "com.leroymerlin.franceapp",
                "appstore_app_id": "522478918",
                "instagram_username": "leroymerlin",
                "stores_count": 140,
            },
            "castorama": {
                "name": "Castorama",
                "website": "https://www.castorama.fr",
                "playstore_app_id": "com.castorama.fr",
                "appstore_app_id": "1163490666",
                "instagram_username": "castoramafrance",
                "stores_count": 100,
            },
            "brico_depot": {
                "name": "Brico Dépôt",
                "website": "https://www.bricodepot.fr",
                "playstore_app_id": "com.bricodepot.android",
                "appstore_app_id": "1497096749",
                "instagram_username": "bricodepot.france",
                "stores_count": 120,
            },
            "mr_bricolage": {
                "name": "Mr Bricolage",
                "website": "https://www.mr-bricolage.fr",
                "playstore_app_id": "com.mrbricolage.app",
                "instagram_username": "mrbricolage_france",
                "stores_count": 400,
            },
            "ikea": {
                "name": "IKEA",
                "website": "https://www.ikea.com/fr",
                "playstore_app_id": "com.ingka.ikea.app",
                "appstore_app_id": "1452164827",
                "instagram_username": "ikeafrance",
                "tiktok_username": "ikea",
                "stores_count": 40,
            },
            "but": {
                "name": "BUT",
                "website": "https://www.but.fr",
                "playstore_app_id": "fr.but.android",
                "appstore_app_id": "498549498",
                "instagram_username": "but_officiel",
                "stores_count": 300,
            },
            "conforama": {
                "name": "Conforama",
                "website": "https://www.conforama.fr",
                "playstore_app_id": "com.conforama.android",
                "appstore_app_id": "1438598091",
                "instagram_username": "conforama_france",
                "stores_count": 200,
            },
        },
    },
    # ==========================================================================
    # ALIMENTAIRE SPÉCIALISÉ
    # ==========================================================================
    "alimentaire_specialise": {
        "name": "Alimentaire Spécialisé",
        "retailers": {
            "picard": {
                "name": "Picard",
                "website": "https://www.picard.fr",
                "playstore_app_id": "com.picard.app",
                "appstore_app_id": "1491103498",
                "instagram_username": "piaborateur_officiel",
                "stores_count": 1100,
            },
            "biocoop": {
                "name": "Biocoop",
                "website": "https://www.biocoop.fr",
                "playstore_app_id": "com.biocoop.app",
                "instagram_username": "biocoop_officiel",
                "stores_count": 700,
            },
            "naturalia": {
                "name": "Naturalia",
                "website": "https://www.naturalia.fr",
                "playstore_app_id": "com.naturalia.app",
                "instagram_username": "naturalia_magasinsbio",
                "stores_count": 200,
            },
            "grand_frais": {
                "name": "Grand Frais",
                "website": "https://www.grandfrais.com",
                "instagram_username": "grandfrais_officiel",
                "stores_count": 300,
            },
        },
    },
    # ==========================================================================
    # RESTAURATION RAPIDE
    # ==========================================================================
    "restauration": {
        "name": "Restauration Rapide",
        "retailers": {
            "mcdonalds": {
                "name": "McDonald's",
                "website": "https://www.mcdonalds.fr",
                "playstore_app_id": "fr.mcdonalds.mcdonaldsapp",
                "appstore_app_id": "1473287455",
                "instagram_username": "mcaborateur_france",
                "tiktok_username": "mcdonaldsfrance",
                "stores_count": 1500,
            },
            "burger_king": {
                "name": "Burger King",
                "website": "https://www.burgerking.fr",
                "playstore_app_id": "com.emn8.mobilem8.burgerking_fr",
                "appstore_app_id": "1500164498",
                "instagram_username": "burgerkingfr",
                "stores_count": 500,
            },
            "kfc": {
                "name": "KFC",
                "website": "https://www.kfc.fr",
                "playstore_app_id": "fr.kfc.app",
                "appstore_app_id": "1520248188",
                "instagram_username": "kfc_france",
                "stores_count": 350,
            },
            "subway": {
                "name": "Subway",
                "website": "https://www.subway.com/fr-FR",
                "playstore_app_id": "com.subway.mobile",
                "appstore_app_id": "398979498",
                "instagram_username": "subwayfrance",
                "stores_count": 400,
            },
            "dominos": {
                "name": "Domino's Pizza",
                "website": "https://www.dominos.fr",
                "playstore_app_id": "com.dominosfr",
                "appstore_app_id": "547740868",
                "instagram_username": "dominosfrance",
                "stores_count": 450,
            },
        },
    },
}


def get_retailer(sector: str, retailer_key: str) -> dict:
    """Récupère les infos d'un retailer."""
    sector_data = RETAILERS.get(sector, {})
    return sector_data.get("retailers", {}).get(retailer_key)


def get_all_retailers_flat() -> list:
    """Retourne tous les retailers en liste plate."""
    result = []
    for sector_key, sector_data in RETAILERS.items():
        for retailer_key, retailer in sector_data.get("retailers", {}).items():
            result.append({
                "key": retailer_key,
                "sector": sector_key,
                "sector_name": sector_data["name"],
                **retailer
            })
    return result


def search_retailers(query: str) -> list:
    """Recherche un retailer par nom."""
    query_lower = query.lower()
    results = []
    for retailer in get_all_retailers_flat():
        if query_lower in retailer["name"].lower():
            results.append(retailer)
    return results
